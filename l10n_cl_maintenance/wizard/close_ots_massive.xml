<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="view_close_ots_massive_wizard" model="ir.ui.view">
        <field name="name">Close Massive OT's</field>
        <field name="model">close.ots.massive</field>
        <field name="arch" type="xml">
            <form string="Parameters">

                <div class="text-center">
                    <field name="option"
                           invisible="0" widget="selection_badge" options="{'horizontal':True}"/>
                </div>

                <group attrs="{'invisible':  [('option', '=', 'close_task')]}">
                    <field name="ot_master_id" invisible="1"/>
                    <field name="select_all_request"
                           attrs="{
                                'invisible':  [('option', 'in', ('close_task','assign_emp'))],
                                'required': [('option', '=', 'close_ot')],
                           }"
                           options="{'no_create':True,'no_create_edit': True,'no_open': True}"
                           widget="many2many_tags"/>
                </group>
                <group attrs="{'invisible':  [('option', 'in', ('close_task','assign_emp'))]}">
                    <field name="closing_comment"
                           widget="text"/>
                </group>


                <group>
                    <field name="option_ots"
                           attrs="{
                                'invisible': [('option', '=', 'close_ot')],
                                'required': [('option', '=', 'close_task')],
                           }"
                           widget="radio" options="{'horizontal':True}"/>

                    <field name="ot_select_id"
                           attrs="{
                                'invisible': ['|',('option', '=', 'close_ot'),  ('option_ots', '!=', 'one')],
                                'required': [('option', '=', 'close_task'), ('option_ots', '=', 'one')],
                           }"
                           options="{'no_create':True,'no_create_edit': True,'no_open': True}"
                           domain="[('ot_master_id', '=', ot_master_id)]"
                    />

                    <field name="ot_select_ids"
                           attrs="{
                                'invisible': ['|',('option', '=', 'close_ot'),  ('option_ots', '!=', 'custom')],
                                'required': [('option', '=', 'close_task'), ('option_ots', '=', 'custom')],
                           }"
                           options="{'no_create':True,'no_create_edit': True,'no_open': True}"
                           widget="many2many_tags"
                           domain="[('ot_master_id', '=', ot_master_id)]"
                           string="OT's"
                    />


                    <field name="flag_employee" widget="boolean_toggle"
                           attrs="{'invisible': [('option', 'in', ('close_ot', 'assign_emp', 'close_task'))]}"/>
                    <field name="specialty_tag_ids"
                           widget="many2many_tags"
                           options="{'color_field': 'color'}"
                           attrs="{
                                'invisible': ['|',('flag_employee', '=', False), ('option', '=', 'close_ot')],
                           }"
                    />
                    <field name="employee_id"
                           domain="[('speciality_ids', 'in', specialty_tag_ids),
                                    '|', ('company_id', '=', False), ('company_id', '=', company_id)
                                   ]"
                           attrs="{
                                'invisible': ['|',('flag_employee', '=', False), ('option', '=', 'close_ot')],
                                'required': [('flag_employee', '=', True),('option', 'in', ('close_task', 'assign_emp'))],
                           }"
                           options="{'no_create': True, 'no_create_edit': True, 'no_open': False}"/>

                    <field name="flag_employees_additional" widget="boolean_toggle"
                           attrs="{'invisible': ['|',('option', '=', 'close_ot'),
                           ('flag_employee', '=', False)]}"/>
                    <field name="employee_ids" widget="many2many_tags"
                           attrs="{
                                'invisible': ['|','|',
                                                ('option', '=', 'close_ot'),
                                                ('flag_employee', '=', False),
                                                ('flag_employees_additional', '=', False),
                                ],
                                'required': [('flag_employees_additional', '=', True)],
                           }"
                           options="{'no_create': True, 'no_create_edit': True, 'no_open': False}"
                    />

                    <field name="time_spent"
                           string="Duración" class="oe_inline" widget="float_time"
                           attrs="{
                                'invisible':  [('option', 'in', ('close_ot','assign_emp'))],
                                'required': [('option', '=', 'close_task')],
                           }"
                    />
                    <field name="description_ph"
                           widget="text"
                           placeholder="Describe your name timesheet..."
                           attrs="{
                                'invisible':  [('option', 'in', ('close_ot','assign_emp'))],
                                'required': [('option', '=', 'close_task')],
                           }"
                    />
                    <field name="company_id" groups="base.group_multi_company"/>
                </group>
                <!-- opciones parte de horas -->
                <div class="alert alert-primary" role="alert"
                     attrs="{'invisible': [('option', 'in', ('close_ot','assign_emp'))]}">
                    <p>Se procederá a cerrar todas las tareas que <b><u>No</u></b> tengan restricciones por solicitud de
                        material
                        pendiente de validación y tengan un empleado asignado asociadas a las órdenes de trabajo, las
                        que no
                        cumplan se marcarán de color <span class="text-danger"><b>rojo</b></span></p>
                </div>

                <div class="alert alert-warning" role="alert"
                     attrs="{'invisible': [('option', '!=', 'assign_emp')]}">
                    <p class="text-bf font-italic">¡Si ya existe empleado asignado se reemplazará por el nuevo empleado, no siendo así para los
                        empleados adicionales los cuales se añaden a los existentes en la tarea!</p>
                </div>
                <footer>
                    <button name="action_close_ot"
                            attrs="{'invisible': [('option', 'in', ('close_task','assign_emp'))]}"
                            string="Accept" type="object" class="btn-primary"/>

                    <button name="action_close_task"
                            attrs="{'invisible': [('option', 'in', ('close_ot','assign_emp'))]}"
                            string="Accept" type="object" class="btn-primary"/>

                    <button name="action_upd_employee_massive"
                            attrs="{'invisible': [('option', '!=', 'assign_emp')]}"
                            string="Accept" type="object" class="btn-primary"/>
                    <button string="Cancel"
                            class="btn-secondary" special="cancel"/>
                </footer>
            </form>
        </field>
    </record>
</odoo>
