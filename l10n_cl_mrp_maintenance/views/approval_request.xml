<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <!-- Inherit Form View to Modify it -->
        <record id="mblz_approval_category_view_form" model="ir.ui.view">
            <field name="name">mblz_approval.category.view.form</field>
            <field name="model">approval.category</field>
            <field name="inherit_id" ref="approvals.approval_category_view_form"/>
            <field name="arch" type="xml">


                <xpath expr="//field[@name='is_manager_approver']" position="before">
                    <!-- Add your fields or attributes here -->
                    <field
                            name="group_ids" string="Grupos permitidos"
                            widget="many2many_tags"
                            options="{'no_create': True, 'no_create_edit': True, 'no_open': False}"
                            domain="[('id', '!=', id)]"
                    />

                </xpath>

                <xpath expr="//field[@name='user_ids']" position="replace">
                    <!--                    <field name="user_id_domain" invisible="0"/>-->
                    <field name="user_ids" widget="many2many_tags" domain="[('groups_id', 'in', group_ids)]"
                           options="{'no_create': True, 'no_create_edit': True, 'no_open': False}"
                    >
                    </field>
                </xpath>

            </field>
        </record>

        <!-- Inherit Form View to Modify it -->
        <record id="mblz_approval_request_view_form" model="ir.ui.view">
            <field name="name">mblz_approval_request_view_form</field>
            <field name="model">approval.request</field>
            <field name="inherit_id" ref="approvals.approval_request_view_form"/>
            <field name="arch" type="xml">

                <xpath expr="//field[@name='request_owner_id']" position="attributes">
                    <attribute name="options">{"no_open": False, "no_create": True, "no_create_edit": True}</attribute>
                </xpath>

                <xpath expr="//field[@name='partner_id']" position="attributes">
                    <attribute name="options">{"no_open": False, "no_create": True, "no_create_edit": True}</attribute>
                </xpath>

                <xpath expr="//field[@name='amount']" position="after">
                    <!-- Add your fields or attributes here -->
                    <field name="request_task_id"
                           attrs="{'invisible': [('request_task_id', '=', False)],
                           'readonly': [('request_task_id', '!=', False)]}"/>
                    <field name="wz_material_add_id" invisible="1"/>
                    <field name="picking_task_mtto_id"
                           readonly="1" string="Picking"
                           attrs="{'invisible': [('picking_task_mtto_id', '=', False)]}"/>
                    <field name="date_approved" attrs="{'invisible': [('date_approved', '=', False)]}"/>
                </xpath>

                <xpath expr="//page[@name='approvers']" position="after">
                    <page name="materials_add" string="Additional Materials"
                          attrs="{'invisible': [('request_task_id', '=', False)]}">
                        <field name='product_line_task_ids'
                               mode="tree"
                               readonly="1"
                               widget="one2many">
                            <tree
                                    string="Materials">
                                <field name="product_id" readonly="1"/>
                                <field name="product_qty"/>
                                <field name="product_uom_id" readonly="1"/>
                                <field name="company_id" groups="base.group_multi_company"/>
                            </tree>
                        </field>
                    </page>

                </xpath>


                <xpath expr="//field[@name='approver_ids']/tree//field[@name='status']" position="after">
                    <field name="date_approved" widget="datetime"/>
                </xpath>

            </field>
        </record>
    </data>
</odoo>